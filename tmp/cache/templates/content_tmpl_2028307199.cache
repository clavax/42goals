<?php echo '<script'?> type="text/javascript">
Data = {};
Data.goals = <?php echo json::encode($goals)?>;
Data.today = '<?php echo (isset($today) ? $today : '')?>
';
</script>
<h2>
    <a href="<?php echo ($Conf->URL->has('this') ? $Conf->URL->{"this"} : 'this')?><?php echo (isset($yesterday) ? $yesterday : '')?>
/">&larr; <?php echo (isset($yesterday_title) ? $yesterday_title : '')?>
</a>
    <b><?php echo (isset($today_title) ? $today_title : '')?>
</b>
    <a href="<?php echo ($Conf->URL->has('this') ? $Conf->URL->{"this"} : 'this')?><?php echo (isset($tomorrow) ? $tomorrow : '')?>
/"><?php echo (isset($tomorrow_title) ? $tomorrow_title : '')?>
 &rarr;</a>
</h2>
<form id="goals-form" method="post" action="<?php echo ($Conf->URL->has('self') ? $Conf->URL->{"self"} : 'self')?>">
    <div id="goals-tabs">
        <select name="tab" id="tab-select">
            <option value=""><?php echo ($Conf->LNG->has('Show_all_goals') ? $Conf->LNG->{"Show_all_goals"} : 'Show_all_goals')?></option>
        <?php foreach ($tabs as $tab) {?>
            <option value="<?php echo (isset($tab['id']) ? $tab['id'] : '')?>
"><?php echo (isset($tab['title']) ? $tab['title'] : '')?>
</option>
        <?php }?>
        </select>
    </div>
    <table id="goals-table">
        <tbody>
            <?php foreach ($goals as $id => $goal) {?>
            <tr id="goal-<?php echo (isset($id) ? $id : '')?>
" class="tab-<?php echo (isset($goal['tab']) ? $goal['tab'] : '')?>
">
                <th><?php echo (isset($goal['title']) ? $goal['title'] : '')?>
</th>
                <td class="data">
                    <?php if ($goal['type'] == 'numeric') {?>
                    <input value="<?php echo (isset($goal['data']['value']) ? $goal['data']['value'] : '')?>
" name="data[<?php echo (isset($id) ? $id : '')?>
]" />
                    <?php } elseif ($goal['type'] == 'counter') {?>
                        <?php if ($goal['data']['value'] > 0) {?>
                            <?php for ($i = 1; $i <= $goal['data']['value'] && $i < 100; $i ++) {?>
                    <button type="submit" name="dec" value="<?php echo (isset($id) ? $id : '')?>
"><img src="<?php echo (isset($goal['icon_item']) ? $goal['icon_item'] : '')?>
" alt="-" /></button>
                            <?php }?>
                    <input type="hidden" value="<?php echo (isset($i) ? $i : '')?>
" name="data[<?php echo (isset($id) ? $id : '')?>
]" />
                        <?php } else {?>
                    <input type="hidden" value="1" name="data[<?php echo (isset($id) ? $id : '')?>
]" />
                        <?php }?>
                    <?php } elseif ($goal['type'] == 'boolean') {?>
                        <?php if ($goal['data']['value'] === '1') {?>
                    <img src="<?php echo (isset($goal['icon_true']) ? $goal['icon_true'] : '')?>
" alt="yes" onclick="Mobile.iterate('<?php echo (isset($id) ? $id : '')?>
')" />
                    <input type="hidden" value="0" name="data[<?php echo (isset($id) ? $id : '')?>
]" />
                        <?php } elseif ($goal['data']['value'] === '0') {?>
                    <img src="<?php echo (isset($goal['icon_false']) ? $goal['icon_false'] : '')?>
" alt="no" onclick="Mobile.iterate('<?php echo (isset($id) ? $id : '')?>
')" />
                    <input type="hidden" value="" name="data[<?php echo (isset($id) ? $id : '')?>
]" />
                        <?php } else {?>
                    <input type="hidden" value="1" name="data[<?php echo (isset($id) ? $id : '')?>
]" />
                        <?php }?>
                    <?php } elseif ($goal['type'] == 'time' || $goal['type'] == 'timer') {?>
                    <select value="" name="data[<?php echo (isset($id) ? $id : '')?>
][h]">
                        <?php for ($i = 0; $i <= 24; $i ++) {?>
                        <option value="<?php echo (isset($i) ? $i : '')?>
"<?php if ($i == array_get($goal, 'h')) {?> selected="selected"<?php }?>><?php echo MobileIndexPage::pad($i)?></option>
                        <?php }?>
                    </select>
                    <b>:</b>
                    <select name="data[<?php echo (isset($id) ? $id : '')?>
][m]">
                        <?php for ($i = 0; $i <= 60; $i ++) {?>
                        <option value="<?php echo (isset($i) ? $i : '')?>
"<?php if ($i == array_get($goal, 'm')) {?> selected="selected"<?php }?>><?php echo MobileIndexPage::pad($i)?></option>
                        <?php }?>
                    </select>
                    <input type="hidden" name="data[<?php echo (isset($id) ? $id : '')?>
][s]" value="<?php echo (isset($goal['s']) ? $goal['s'] : '')?>
" />
                    <?php } else {?>
                    <?php echo (isset($goal['type']) ? $goal['type'] : '')?>

                    <?php }?>
                </td>
                <td class="add">
                    <button type="submit" name="id" value="<?php echo (isset($id) ? $id : '')?>
"><img src="<?php echo ($Conf->URL->has('img') ? $Conf->URL->{"img"} : 'img')?>site/+.png" alt="+" onclick="Mobile.input('<?php echo (isset($id) ? $id : '')?>
')" /></button>
                </td>
            </tr>
            <?php }?>
        </tbody>
    </table>
</form>